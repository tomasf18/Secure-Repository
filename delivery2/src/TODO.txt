
WHEN A SUBJECT IS SUSPENDED/REMOVED FROM A MANAGER ROLE, I MUST ENSURE THAT, IF HE IS A MANAGER, THERE IS AT LEAST ONE MORE MANAGER AT THET ORG -> DONE
WHEN A DOCUMENT IS ADDED, ADD TO DocumentRolePermission TABLE ALL THE DOCUMENT PERMISSIONS TO MANAGER ROLE! -> DONE
WHEN ADDING A SUBJECT TO A MANAGER ROLE, MAKE SURE TO GIV HIM ALL THE PERMISSIONS (it's the manager who has the permissions, not the subject) -> DONE 
VERIFY IF THE SUBJECT, WHEN ASSMING A ROLE, HAS THAT ROLE IN THE ORG -> DONE
ALSO STORE THE SALT USED TO ENCRYPT THE CONTENT STORED BY THE REPO -> DONE
# TODO: Encrypt
# Create response
result = {
    "session_id": session.id,
    "username": session.subject_username,
    "organization": session.organization_name,
    "roles": [role.name for role in session.session_roles],
    "public_key": base64.b64encode(session_server_public_key).decode('utf-8'), # So that the client can generate the shared secret (key for the session symmetric encryption)
    "nonce": nonce,
}
TIME TO LIVE OF THE SESSIONS -> DONE
tirar ao manager todas as permissoes de um documento -> DONE
rep_suspend_subject         // Vou a todas as sessoes dele e elimio as e depois, no create, session vejo se ele esta suspenso (e no suspend role tmb) -> DONE
A DOC_ACL access right allows a role holder to add or remove access rights for other roles. At least one role must keep this right for each document, in order to allow an ACL to be updated. -> Doc
ROLE_ACL: Modify the ACL. At least one role must have this permission. -> Done (manager)

---
ROLE_DOWN: Suspend a role, allowing a role to suspend a role from being assumed by subjects of an organization. 
@João Paulo Barraca Aqui quando diz "suspend a role from being assumed by subjects", implica que não podemos atribuir esse role a nenhum subject enquanto este está suspenso e também que qualquer sujeito que já estivesse associado a esse role o "perdesse" (seria inutilizável até que fosse ativado outra vez), ou só o primeiro caso?
Imagem
João Paulo Barraca — Ontem às 21:53
Não está definido. O texto diz que não pode ser assumida, mas não diz nada sobre ser ou não ser atribuída.
Para quem já a tem assumida.... undefined behaviour

ROLE_UP: Reactivate a role, allowing a role to put an end on a role’s suspension.

BUT ...
```txt
rep_suspend_role <session file> <role>
rep_reactivate_role <session file> <role>

These commands change the status of a role in the organization with which I have currently a session. These commands require a ROLE_DOWN and ROLE_UP permission, respectively.
```
AND ...
```
In this sense, they act as groups of subjects in normal ACLs.
```

It is possible for a subject to maintain simultaneous sessions with different organizations in the Repository. -> I think it's possible

Sessions have a lifetime defined by the Repository, and should be deleted upon a period of inactivity. -> TODO (last_interaction -> update load session)
Do not allow simultaneous sessions by the same user on the same org


CORRECT ERROR MESSAGES FOR EACH COMMAND, SO THAT NO USEFUL MESSAGE FOR ATTACKERS IS SHOWN
TRY WIRESHARK TO SEE ENCRYPTED/PLAINTEXT CONTENT
No comando rep_list_role_permissions nós retornamos as permissões de um dado role incluindo as permissões do role nos documentos.


DONT FORGET: DO NOT RESET THE DATABASE BETWEEN SERVER REINITS, BUT USE THAT AS A THIRD FUNCTION INSTEAD (add an endpoint do that client can delete all the data from the repo)